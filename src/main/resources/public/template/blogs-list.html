<div class="row">
	<a class="button right-magnet" ng-href="#/edit/new" workflow="blog.create" class="right-magnet cell">
		<i18n>blog.create.blog</i18n>
	</a>
	<app-title>
		<h1><a href="#/list-blogs"><i class="blog"></i><i18n>blog.title</i18n></a></h1>
	</app-title>
</div>

<div class="row rigid-grid">
	<section class="four cell">
		<div class="margin-two row">
			<input type="search" class="eleven cell" i18n-placeholder="search" ng-model="display.search" ng-keyup="$event.keyCode == 13 ? launchSearching(display.search, $event) : resetSearching()" />
		</div>
		<nav class="vertical" side-nav>
			<ul>
				<li>
					<a>
						<i class="arrow"></i>
						<i18n>projects.root</i18n>
					</a>
					<ul>
						<div ng-if="root.contains(currentFolder)">
							<li ng-repeat="folder in root.children.all">
								<a><i class="arrow" ng-if="folder.children.length"></i>[[folder.name]]</a>
								<ul ng-include="'folder-tree'"></ul>
							</li>
						</div>
					</ul>
				</li>
				<li ng-click="openTrash()">
					<a><i18n>folder.trash</i18n></a>
				</li>
			</ul>
			<a class="classic-link"><i18n>folder.new</i18n></a>
		</nav>
	</section>
	<section class="margin-four">
		<div class="twelve cell chips">
			<label class="chip">
				<i class="mine" tooltip="filters.mine"></i>
				<i18n>filters.privateSites</i18n>
				<input type="checkbox" ng-model="filters.protected" />
			</label>
			<label class="chip">
				<i class="public" tooltip="filters.publicSites"></i>
				<i18n>filters.publicSites</i18n>
				<input type="checkbox" ng-model="filters.public" />
			</label>
		</div>
		<div class="fallen dominos">
			<!-- Vu pour les dossiers -->
			<!-- <div ng-repeat="blog in blogs.all | orderBy:orderBlogs:true" ng-click="redirect('/view/' + blog._id)" bottom-scroll="loadBlogs()">
				<explorer ng-model="folder.selected" on-open="openFolder(folder)" class="folder item">
					<section class="domino" dragstart ng-model="folder._id" dragdrop="dropTo(folder, $originalEvent)">
						<div class="top">
							<img skin-src="[[blog.icon]]" class="absolute" />
						</div>
						<div class="bottom">
							<div class="content">
								<strong>[[blog.shortenedTitle]]</strong>
							</div>
						</div>
					</section>
				</explorer>
			</div> -->
			<div ng-repeat="blog in blogs.all | orderBy:orderBlogs:true" ng-click="redirect('/view/' + blog._id)" bottom-scroll="loadBlogs()">
				<explorer ng-model="folder.selected" on-open="openFolder(folder)" class="item">
					<section class="domino" dragstart ng-model="website._id">
						<div class="top">
							<!-- Il faut mettre la bonne condition dans le ng-if -->
							<!-- <img skin-src="/img/illustrations/pages-default.png" alt="thumbnail" ng-if="!website.icon" class="absolute">
							<img ng-src="[[blog.icon]]" alt="thumbnail" ng-if="website.icon" class="absolute" /> -->
							<img skin-src="[[blog.icon]]" class="absolute" />
						</div>
						<div class="bottom">
							<div class="content">
								<strong class="block overflow-hd" ng-click="displayBlog(blog)">[[blog.shortenedTitle]]</strong>
								<span class="cell-ellipsis block">[[blog.author.username]]</span>
								<em class="smaller-text block"><i18n>modified.on</i18n></em>
								<br />
								<div class="icons">
									<!-- Il faut revoir les conditions du ng-if -->
									<i class="shared inline" ng-if="website.shared.length > 0" tooltip="tooltip.shared"></i>
									<i class="public" ng-if="website.visibility === 'PUBLIC'" tooltip="tooltip.public"></i>
									<i class="manage" ng-if="website.myRights.manager" tooltip="tooltip.manager"></i>
									<i class="edit" ng-if="!website.myRights.manager && website.myRights.update" tooltip="tooltip.update"></i>
									<i class="view" ng-if="!website.myRights.update" tooltip="tooltip.read"></i>
								</div>
							</div>
						</div>
					</section>
				</explorer>
			</div>
		</div>
	</section>
</div>

<lightbox show="display.showShare" on-close="display.showShare = false">
	<container template="share"></container>
</lightbox>

<lightbox show="display.confirmRemoveBlog" on-close="display.confirmRemoveBlog = false">
	<h2><i18n>remove</i18n></h2>
	<p><i18n>confirm.remove.blog</i18n></p>
	<div class="row">
		<button ng-click="removeBlogs(); display.confirmRemoveBlog = false" class="right-magnet">
			<i18n>remove</i18n>
		</button>
		<button type="button" ng-click="display.confirmRemoveBlog = false" class="right-magnet cancel">
			<i18n>cancel</i18n>
		</button>
	</div>
</lightbox>

<div class="toggle-buttons" ng-class="{ hide: blogs.selection().length < 1 }">
	<div class="row toggle">
		<a class="button" ng-href="#/edit/[[blogs.selection()[0]._id]]" ng-if="blogs.selection().length === 1" authorize="editBlog" resource="blogs.selection()">
			<i18n>properties</i18n>
		</a>
		<button ng-click="shareBlog()" authorize="share" resource="blogs.selection()">
			<i18n>share</i18n>
		</button>
		<button ng-click="display.confirmRemoveBlog = true" authorize="removeBlog" resource="blogs.selection()">
			<i18n>remove</i18n>
		</button>
	</div>
</div>
